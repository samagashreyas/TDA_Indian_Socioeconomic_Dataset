---
title: "R Notebook"
output: html_notebook
---

```{r}
data_AM=read.csv("data_AM.csv")
data_GM=read.csv("data_GM.csv")
library(TDA)
library(igraph)
```

```{r}
indian_state_graph = make_empty_graph(n=0, directed = FALSE)
state_names = c("AP", "AR", "AS", "BR", "CG", "DL", "GA", "GJ", "HR", "HP", "JK", "JH", "KA", "KL", "MP", "MH", "MN", "ML", "MZ", "NL", "OD", "PB", "RJ", "SK", "TN", "TS", "TR", "UP", "UK", "WB")
indian_state_graph = add_vertices(indian_state_graph, 30, label = state_names)
indian_state_graph = add_edges(indian_state_graph, c(1,25, 1,13, 1,26, 1,5, 1,21, 2,3, 2,20, 3,20, 3,17, 3,19, 3,27, 3,18, 3,30, 4,30, 4,12, 4,28, 5,12, 5,21, 5,26, 5,16, 5,15, 5,28, 6,28, 6,9, 7,16, 7,13, 8,23, 8,15, 8,16, 9,10, 9,28, 9,23, 9,22, 10,11, 10,29, 10,22, 11,22, 12,30, 12,21, 12,28, 13,16, 13,26, 13,25, 13,14, 14,25, 15,28, 15,16, 15,23, 16,26, 17,20, 17,19, 19,27, 21,30, 22,23, 23,28, 24,30, 28,29))
plot(indian_state_graph)
dist=distances(indian_state_graph)
```

```{r}
graph_dist_AM=matrix(0, nrow = nrow(dist), ncol = ncol(dist))
for (i in 1:nrow(dist)){
  for (j in 1:ncol(dist)){
    temp=0
    for (k in 1:ncol(data_AM)){
      temp=temp+((data_AM[i,k]-data_AM[j,k])^2)
    }
    graph_dist_AM[i,j]=dist[i,j]*sqrt(temp)
  }
}
```

```{r}
graph_dist_GM=matrix(0, nrow = nrow(dist), ncol = ncol(dist))
for (i in 1:nrow(dist)){
  for (j in 1:ncol(dist)){
    temp=0
    for (k in 1:ncol(data_GM)){
      temp=temp+((data_GM[i,k]-data_GM[j,k])^2)
    }
    graph_dist_GM[i,j]=dist[i,j]*sqrt(temp)
  }
}
```


```{r}
diag_AM=ripsDiag(X=graph_dist_AM, maxdimension = 1, maxscale = 2, dist = "arbitrary", library = "Dionysus", location = TRUE, printProgress = TRUE)
plot(diag_AM[["diagram"]], barcode=TRUE)
```

```{r}
diag_GM=ripsDiag(X=graph_dist_GM, maxdimension = 1, maxscale = 2, dist = "arbitrary", library = "Dionysus", location = TRUE, printProgress = TRUE)
plot(diag_GM[["diagram"]], barcode=TRUE)
```

```{r}
diag_AM
```

```{r}
diag_GM
```


